openapi: 3.0.0
info:
  title: Smart 3D Mobile API
  version: 1.1.0
  description: API for 3D printing service integration with advanced pricing logic.

servers:
  - url: http://localhost:8000
    description: Gateway server

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

paths:
  /register:
    post:
      summary: Register new user
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                email: { type: string }
                password: { type: string }
              required: [email, password]
      responses:
        '200':
          description: OK
  
  /login:
    post:
      summary: Login user
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                email: { type: string }
                password: { type: string }
              required: [email, password]
      responses:
        '200':
          description: OK

  /me:
    get:
      summary: Get current user info
      security:
        - bearerAuth: []
      responses:
        '200':
          description: OK

  /create_order:
    post:
      summary: Create 3D printing order with advanced price calculation
      security:
        - bearerAuth: []
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                description: { type: string }
                material: { type: string, enum: [PLA, ABS, PETG, TPU, Nylon, SLA] }
                color: { type: string }
                width: { type: number, minimum: 1, maximum: 500, description: "X axis (mm)" }
                length: { type: number, minimum: 1, maximum: 500, description: "Y axis (mm)" }
                height: { type: number, minimum: 1, maximum: 500, description: "Z axis (mm)" }
                infill: { type: number, minimum: 0, maximum: 100, description: "Infill % (0-100)" }
                real_weight: { type: number, minimum: 0, maximum: 10000, description: "W (grams)" }
                file: { type: string, format: binary }
      responses:
        '200':
          description: Order created with calculated price
          content:
            application/json:
              schema:
                type: object
                properties:
                  message: { type: string }
                  order_id: { type: integer }
                  price: { type: number }
                  currency: { type: string }

  /orders:
    get:
      summary: Get list of user orders
      security:
        - bearerAuth: []
      responses:
        '200':
          description: OK

  /resend-verification:
    post:
      summary: Resend email verification link
      requestBody:
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                email: { type: string }
      responses:
        '200':
          description: OK
